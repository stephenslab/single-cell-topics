---
title: "Identify clusters in 68k PBMC data using topic model"
author: Peter Carbonetto
output: workflowr::wflow_html
---

Here we identify clusters of cells from the mixture proportions
estimated in the 68k PBMC data.

```{r knitr-opts, include=FALSE}
knitr::opts_chunk$set(comment = "#",collapse = TRUE,results = "hold",
                      fig.align = "center",dpi = 120)
```

Load the packages used in the analysis below, as well as additional
functions that we will use to generate some of the plots.

```{r load-pkgs, message=FALSE}
library(Matrix)
library(fastTopics)
library(ggplot2)
library(cowplot)
```

Load the count data.

```{r load-data}
load("../data/pbmc_68k.RData")
```

Load the $K = 12$ Poisson NMF model fit.

```{r load-fit}
fit <- readRDS("../output/pbmc-68k/rds/fit-pbmc-68k-scd-ex-k=12.rds")$fit
```
